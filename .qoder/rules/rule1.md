---
trigger: manual
---
Диалоги давай вести на русском языке. И делаем все шаги поэтапно, каждый пункт этапа по окончанию говорим "Пункт N закончен. Приступаем к следующему ? и наименование пункта"
Архитектура клиента построена на эмуляции браузера:
FormMain использует ExtendedWebBrowser для отображения игрового контента
Локальный прокси-сервер ABProxy на порту 8052 перехватывает весь HTTP трафик
CookiesManager управляет сессиями и аутентификацией
Ключевые точки для Android портирования:
Игра взаимодействует с www.neverlands.ru через стандартные HTTP запросы
Аутентификация через cookies (особенно NeverNick cookie)
API endpoints: /modules/api/getid.cgi, /modules/api/info.cgi
Использует кодировку windows-1251
Пункт 1 закончен. Приступаем к следующему - Пункт 2: Изучение API взаимодействия с игровым сервером neverlands.ru
Основные API endpoints для Android клиента:
/modules/api/getid.cgi - получение ID игрока по нику
/modules/api/info.cgi - детальная информация (HP, MP, экипировка, эффекты)
/main.php - основной игровой интерфейс
/ch.php - чат и информация о комнате
Критические моменты для эмуляции:
Все запросы используют cookies (особенно NeverNick)
Кодировка windows-1251 для русского языка
User-Agent должен имитировать обычный браузер
Серверное время синхронизируется через HTTP заголовки
Структура данных UserInfo:
Полная информация о персонаже (HP, MP, экипировка, статус онлайн)
Формат ответа: разделители | и @ для парсинга
лючевые выводы для Android реализации:

Профили пользователей:
UserConfig содержит все настройки пользователя (ник, пароли, настройки прокси)
Поддержка шифрования паролей для безопасности
Автоматический вход через AutoLogon с таймером
Cookie-система:
CookiesManager управляет всеми cookies через CookiePack
Критический cookie NeverNick содержит имя пользователя
Автоматическая проверка соответствия логина и cookie
Сессии через прокси:
Все HTTP запросы проходят через локальный прокси
Автоматическое добавление Cookie заголовков к каждому запросу
Обработка Set-Cookie ответов от сервера
Безопасность:
Специальная аутентификация через /modules/abclient/auth.php
3DES шифрование для критических данных
UserKey для дополнительной проверки подлинности